---
import IconExternal from "@/assets/icons/icon_external.svg";
import Text from "@/elements/Text.astro";
import Link from "./Link.astro";

const {
  url,
  text,
  label,
  icon: Icon,
  isExternal,
  isSmall = false,
  as = "a",
  type = "button",
  class: className = "",
} = Astro.props;

const classList = ["container"];

if (isSmall) classList.push("container-small");
if (className) classList.push(className);
---

<div class={classList.join(" ")}>
  {
    label && !isSmall && (
      <div class="content-text">
        <Text color="primary" size="small" nowrap>
          {label}
        </Text>
      </div>
    )
  }
  <div class="button">
    {
      as === "a" ? (
        <Link
          url={url}
          class="content"
          target={isExternal ? "_blank" : "_self"}
          rel={isExternal ? "noopener noreferrer" : undefined}
        >
          <Icon width={isSmall ? 32 : 36} height={isSmall ? 32 : 36} />

          {text && !isSmall && (
            <Text color="primary" weight="bold">
              {text}
            </Text>
          )}

          {isExternal && (
            <div class="icon icon-external">
              <IconExternal width={18} height={18} />
            </div>
          )}
        </Link>
      ) : (
        <button type={type} class="content">
          <Icon width={isSmall ? 32 : 36} height={isSmall ? 32 : 36} />

          {text && !isSmall && (
            <Text color="primary" weight="bold">
              {text}
            </Text>
          )}
        </button>
      )
    }
  </div>
</div>

<style lang="scss">
  @use "@/styles/tokens" as *;
  @use "@/styles/utilities" as *;

  .container {
    @include box;

    align-items: center;

    :global(.content) {
      @include box(small);

      flex-direction: row;
      align-items: center;
      padding: sp(small) sp(normal) sp(small) sp(small);
      color: t(text, primary);
      cursor: pointer;
      background-color: unset;
      border: none;
    }

    &-small {
      :global(.content) {
        padding: sp(small);
      }
    }
  }

  .button {
    @include card(small);

    transition: 0.2s ease-in-out;

    &:hover {
      transform: scale(1.05);
      transition: 0.2s ease-in-out;
    }
  }

  .icon {
    &-external {
      opacity: 0.5;
    }
  }
</style>
